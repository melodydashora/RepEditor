<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vecto Pilot - AI Assistant</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            overflow: hidden;
        }
        .layout {
            display: flex;
            height: 100vh;
        }
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        .sidebar {
            width: 350px;
            background: #1e293b;
            border-left: 1px solid #334155;
            overflow-y: auto;
            padding: 20px;
        }
        .sidebar h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .file-tree {
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
        }
        .tree-item {
            padding: 4px 8px;
            cursor: pointer;
            border-radius: 4px;
            margin: 2px 0;
            user-select: none;
            transition: background 0.2s;
        }
        .tree-item:hover {
            background: #334155;
        }
        .tree-item.active {
            background: #667eea;
        }
        .tree-folder {
            color: #fbbf24;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
        }
        .tree-folder:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        .tree-file {
            color: #94a3b8;
            cursor: pointer;
        }
        .tree-file:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        .folder-arrow {
            display: inline-block;
            width: 12px;
            font-size: 10px;
            transition: transform 0.2s ease;
        }
        .tree-children {
            transition: all 0.2s ease;
        }
        .tree-children {
            margin-left: 16px;
        }
        .container { max-width: 100%; margin: 0; padding: 0; }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-content h1 { font-size: 2em; margin-bottom: 10px; }
        .header-content p { opacity: 0.9; }
        .header-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .header-controls select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        .header-controls select:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
        }
        .header-controls select:focus {
            border-color: white;
        }
        .header-controls select option {
            background: #1e293b;
            color: #e2e8f0;
        }
        .chat-container {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 500px;
            max-height: 600px;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            animation: slideIn 0.3s ease;
        }
        .tool-calls {
            background: #0f172a;
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 3px solid #10b981;
            font-size: 0.9em;
        }
        .tool-call {
            margin: 5px 0;
            font-family: monospace;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .user-message {
            background: #667eea;
            margin-left: 20%;
            text-align: right;
        }
        .assistant-message {
            background: #334155;
            margin-right: 20%;
        }
        .input-container {
            display: flex;
            gap: 10px;
            background: #1e293b;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        #messageInput {
            flex: 1;
            padding: 15px;
            border: 2px solid #334155;
            border-radius: 8px;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s;
        }
        #messageInput:focus {
            border-color: #667eea;
        }
        button {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .links {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
        }
        .links a {
            color: #667eea;
            text-decoration: none;
            margin: 0 15px;
            font-weight: 600;
            transition: color 0.3s;
        }
        .links a:hover {
            color: #764ba2;
        }
        pre {
            background: #0f172a;
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 10px 0;
            border-left: 3px solid #667eea;
        }
        code {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .settings-btn {
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
        }
        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: rotate(90deg);
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        .modal-overlay.active {
            display: flex;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-content {
            background: #1e293b;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.3s ease;
            border: 1px solid #334155;
        }
        .modal-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #334155;
        }
        .modal-header h2 {
            color: #667eea;
            font-size: 1.5em;
            margin: 0;
        }
        .modal-body {
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #e2e8f0;
            font-weight: 600;
            font-size: 0.95em;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #334155;
            border-radius: 8px;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus {
            border-color: #667eea;
        }
        .form-group select option {
            background: #1e293b;
            color: #e2e8f0;
        }
        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        .modal-footer button {
            padding: 12px 24px;
            font-size: 0.95em;
        }
        .btn-secondary {
            background: #334155 !important;
        }
        .btn-secondary:hover {
            background: #475569 !important;
        }
        .btn-connect {
            background: #10b981 !important;
            margin-bottom: 10px;
        }
        .btn-connect:hover {
            background: #059669 !important;
        }
    </style>
</head>
<body>
    <div class="layout">
        <div class="main-content">
            <div class="header">
                <div class="header-content">
                    <h1>🤖 Vecto Pilot AI Assistant</h1>
                    <p>Choose your AI provider, model, and parameters</p>
                </div>
                <div class="header-controls">
                    <select id="providerSelect" onchange="onProviderChange()">
                        <option value="">⚠️ No SDK Selected</option>
                        <option value="openai">OpenAI SDK</option>
                    </select>
                    <select id="modelSelect" onchange="onModelChange()" style="display: none;">
                        <option value="">Select Model</option>
                    </select>
                    <select id="paramNameSelect" onchange="onParamNameChange()" style="display: none;">
                        <option value="">Select Parameter</option>
                    </select>
                    <select id="paramValueSelect" onchange="onParamValueChange()" style="display: none;">
                        <option value="">Select Value</option>
                    </select>
                    <button class="settings-btn" onclick="openSettings()" title="Settings">
                        ⚙️
                    </button>
                </div>
            </div>

        <div class="chat-container" id="chatContainer">
            <div class="message assistant-message">
                <strong>AI Assistant:</strong><br>
                Hello! I'm your Vecto Pilot AI assistant. I can help you:
                <ul style="margin-top: 10px; margin-left: 20px;">
                    <li>Edit and refactor code in your repository</li>
                    <li>Explain the MLOps infrastructure</li>
                    <li>Debug issues and suggest improvements</li>
                    <li>Generate new features or endpoints</li>
                </ul>
                <br>What would you like to work on?
            </div>
        </div>

        <div class="input-container">
            <input 
                type="text" 
                id="messageInput" 
                placeholder="Ask me to edit code, explain features, or help with your repo..."
                onkeypress="if(event.key==='Enter') sendMessage()"
            >
            <button onclick="sendMessage()" id="sendBtn">Send</button>
        </div>

        <div class="links">
            <a href="/docs">📚 API Documentation</a>
            <a href="/api/diagnostics">🔍 System Diagnostics</a>
            <a href="/api/mlops/observability/metrics">📊 MLOps Metrics</a>
        </div>
        </div>

        <div class="sidebar">
            <h3>📁 Repository Files</h3>
            <div style="margin-bottom: 15px;">
                <button onclick="testChat()" style="width: 100%; padding: 10px; font-size: 0.9em;">
                    🧪 Test GPT-5 Connection
                </button>
            </div>
            <div class="file-tree" id="fileTree">
                <div style="color: #64748b; font-style: italic;">Loading file tree...</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="settingsModal" onclick="closeModalOnBackdrop(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span style="font-size: 1.5em;">⚙️</span>
                <h2>Replit Settings</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="replitUsername">Replit Username</label>
                    <input type="text" id="replitUsername" placeholder="Enter your Replit username">
                </div>
                <div class="form-group">
                    <label for="replitPassword">Replit Password</label>
                    <input type="password" id="replitPassword" placeholder="Enter your Replit password">
                </div>
                <div class="form-group">
                    <label for="replitApp">Replit App</label>
                    <select id="replitApp">
                        <option value="">Select app to work on</option>
                    </select>
                </div>
                <button onclick="connectReplitApp()" class="btn-connect" style="width: 100%;">
                    Connect
                </button>
            </div>
            <div class="modal-footer">
                <button onclick="closeSettings()" class="btn-secondary">Close</button>
                <button onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <script>
        const chatContainer = document.getElementById('chatContainer');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        
        // Current AI configuration
        let currentProvider = null;
        let currentModel = null;
        let currentParams = {};

        // Handle provider selection
        async function onProviderChange() {
            const providerSelect = document.getElementById('providerSelect');
            const modelSelect = document.getElementById('modelSelect');
            const paramsSelect = document.getElementById('paramsSelect');
            
            currentProvider = providerSelect.value;
            
            if (!currentProvider) {
                modelSelect.style.display = 'none';
                paramsSelect.style.display = 'none';
                return;
            }
            
            // Show model dropdown and fetch available models
            modelSelect.style.display = 'inline-block';
            modelSelect.innerHTML = '<option value="">Loading models...</option>';
            
            try {
                const response = await fetch(`/api/providers/${currentProvider}/models`);
                const data = await response.json();
                
                modelSelect.innerHTML = '<option value="">Select Model</option>';
                data.models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.id;
                    option.textContent = model.name || model.id;
                    modelSelect.appendChild(option);
                });
            } catch (error) {
                modelSelect.innerHTML = '<option value="">Error loading models</option>';
                addMessage(`Error fetching models for ${currentProvider}: ${error.message}`, 'assistant');
            }
        }

        // Handle model selection - show parameter names
        function onModelChange() {
            const modelSelect = document.getElementById('modelSelect');
            const paramNameSelect = document.getElementById('paramNameSelect');
            const paramValueSelect = document.getElementById('paramValueSelect');
            
            currentModel = modelSelect.value;
            
            if (!currentModel) {
                paramNameSelect.style.display = 'none';
                paramValueSelect.style.display = 'none';
                return;
            }
            
            // Show parameter name dropdown
            paramNameSelect.style.display = 'inline-block';
            paramValueSelect.style.display = 'none';
            paramNameSelect.innerHTML = '<option value="">Select Parameter</option>';
            
            if (currentProvider === 'openai') {
                let paramOptions = [];
                
                // O1/O3 models
                if (currentModel.startsWith('o1-') || currentModel.startsWith('o3-')) {
                    paramOptions = ['max_completion_tokens'];
                }
                // GPT-5 models (NOT codex/audio/realtime/image/search)
                else if (currentModel.startsWith('gpt-5') && !currentModel.includes('codex') && 
                         !currentModel.includes('audio') && !currentModel.includes('realtime') && 
                         !currentModel.includes('image') && !currentModel.includes('search')) {
                    paramOptions = ['reasoning_effort', 'verbosity', 'max_completion_tokens'];
                }
                // Specialized models (codex, audio, etc.) - NO parameters supported
                else if (currentModel.includes('codex') || currentModel.includes('audio') ||
                         currentModel.includes('realtime') || currentModel.includes('image') ||
                         currentModel.includes('search')) {
                    paramOptions = []; // No parameters
                }
                // GPT-4o/4.1 models
                else if (currentModel.startsWith('gpt-4o') || currentModel.startsWith('gpt-4.1')) {
                    paramOptions = ['temperature', 'max_tokens'];
                }
                // GPT-3.5/4 (legacy)
                else {
                    paramOptions = ['temperature', 'max_tokens'];
                }
                
                paramOptions.forEach(param => {
                    const option = document.createElement('option');
                    option.value = param;
                    option.textContent = param.replace('_', ' ').replace(/\b\w/g, c => c.toUpperCase());
                    paramNameSelect.appendChild(option);
                });
            }
        }
        
        // Handle parameter name selection - show parameter values
        function onParamNameChange() {
            const paramNameSelect = document.getElementById('paramNameSelect');
            const paramValueSelect = document.getElementById('paramValueSelect');
            
            const paramName = paramNameSelect.value;
            
            if (!paramName) {
                paramValueSelect.style.display = 'none';
                return;
            }
            
            paramValueSelect.style.display = 'inline-block';
            paramValueSelect.innerHTML = '<option value="">Select Value</option>';
            
            let values = [];
            
            if (paramName === 'reasoning_effort') {
                values = ['minimal', 'low', 'medium', 'high'];
            } else if (paramName === 'verbosity') {
                values = ['low', 'medium', 'high'];
            } else if (paramName === 'temperature') {
                values = ['0.3', '0.5', '0.7', '1.0', '1.5'];
            } else if (paramName === 'max_tokens' || paramName === 'max_completion_tokens') {
                values = ['1000', '2000', '4000', '8000', '16000', '32000'];
            }
            
            values.forEach(value => {
                const option = document.createElement('option');
                option.value = value;
                option.textContent = value;
                paramValueSelect.appendChild(option);
            });
        }
        
        // Handle parameter value selection
        function onParamValueChange() {
            const paramNameSelect = document.getElementById('paramNameSelect');
            const paramValueSelect = document.getElementById('paramValueSelect');
            
            const paramName = paramNameSelect.value;
            const paramValue = paramValueSelect.value;
            
            if (paramName && paramValue) {
                currentParams[paramName] = paramValue;
            }
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addMessage(message, 'user');
            messageInput.value = '';
            sendBtn.disabled = true;

            try {
                // Build request with provider/model/params if selected
                const requestBody = { message };
                
                if (currentProvider && currentModel) {
                    requestBody.provider = currentProvider;
                    requestBody.model = currentModel;
                    requestBody.params = currentParams;
                    
                    // Show configuration being used
                    const configInfo = `🔧 Using: ${currentModel}`;
                    const paramsInfo = Object.keys(currentParams).length > 0 
                        ? ` | ${Object.entries(currentParams).map(([k,v]) => `${k}=${v}`).join(', ')}`
                        : '';
                    addMessage(configInfo + paramsInfo, 'system');
                }
                
                // Call your backend API endpoint
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });

                const data = await response.json();
                
                // Add assistant response with tool calls
                addMessage(data.response || 'Sorry, I encountered an error.', 'assistant', data.tool_calls);
            } catch (error) {
                addMessage(`Error: ${error.message}. Make sure API keys are configured.`, 'assistant');
            }

            sendBtn.disabled = false;
            messageInput.focus();
        }

        function addMessage(text, role, toolCalls = null) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}-message`;
            
            // System messages (configuration info) have lighter styling
            if (role === 'system') {
                messageDiv.style.opacity = '0.7';
                messageDiv.style.fontSize = '0.9em';
                messageDiv.style.fontStyle = 'italic';
            }
            
            const formattedText = text.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, lang, code) => {
                return `<pre><code>${escapeHtml(code.trim())}</code></pre>`;
            });
            
            let toolCallsHtml = '';
            if (toolCalls && toolCalls.length > 0) {
                toolCallsHtml = '<div class="tool-calls">🛠️ Tools used:<br>';
                toolCalls.forEach(tc => {
                    toolCallsHtml += `<div class="tool-call">• ${tc.function}(${JSON.stringify(tc.args).slice(0, 100)}...)</div>`;
                });
                toolCallsHtml += '</div>';
            }
            
            const roleLabel = role === 'user' ? 'You' : (role === 'system' ? '' : 'AI Assistant');
            const rolePrefix = roleLabel ? `<strong>${roleLabel}:</strong><br>` : '';
            messageDiv.innerHTML = `${rolePrefix}${toolCallsHtml}${formattedText}`;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load file tree
        async function loadFileTree() {
            try {
                const response = await fetch('/api/files/tree');
                const tree = await response.json();
                const fileTreeDiv = document.getElementById('fileTree');
                fileTreeDiv.innerHTML = renderTree(tree);
            } catch (error) {
                console.error('Error loading file tree:', error);
            }
        }

        function renderTree(items, level = 0, parentId = '') {
            if (!items || items.length === 0) return '';
            
            let html = '';
            items.forEach((item, index) => {
                const itemId = `${parentId}-${index}`;
                const indent = '  '.repeat(level);
                const hasChildren = item.children && item.children.length > 0;
                
                if (item.type === 'directory') {
                    // Directory: expandable/collapsible
                    const arrow = hasChildren ? '▶' : '';
                    const folderIcon = '📁';
                    
                    html += `<div class="tree-item tree-folder" onclick="toggleFolder('${itemId}')" title="${item.path}">`;
                    html += `${indent}<span id="arrow-${itemId}" class="folder-arrow">${arrow}</span> ${folderIcon} ${item.name}`;
                    html += `</div>`;
                    
                    if (hasChildren) {
                        html += `<div id="children-${itemId}" class="tree-children" style="display: none;">`;
                        html += renderTree(item.children, level + 1, itemId);
                        html += `</div>`;
                    }
                } else {
                    // File: clickable
                    html += `<div class="tree-item tree-file" onclick="readFileFromTree('${item.path}')" title="${item.path}">`;
                    html += `${indent}📄 ${item.name}`;
                    html += `</div>`;
                }
            });
            
            return html;
        }
        
        function toggleFolder(folderId) {
            const childrenDiv = document.getElementById(`children-${folderId}`);
            const arrowSpan = document.getElementById(`arrow-${folderId}`);
            
            if (childrenDiv) {
                const isHidden = childrenDiv.style.display === 'none';
                childrenDiv.style.display = isHidden ? 'block' : 'none';
                arrowSpan.textContent = isHidden ? '▼' : '▶';
            }
        }

        function readFileFromTree(filePath) {
            messageInput.value = `Read the file: ${filePath}`;
            sendMessage();
        }

        // Test GPT-5 connection
        async function testChat() {
            messageInput.value = 'Hello! Are you working? Please confirm.';
            sendMessage();
        }

        // Settings modal functions
        function openSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.add('active');
        }

        function closeSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.remove('active');
        }

        function closeModalOnBackdrop(event) {
            if (event.target === event.currentTarget) {
                closeSettings();
            }
        }

        async function connectReplitApp() {
            const username = document.getElementById('replitUsername').value.trim();
            const password = document.getElementById('replitPassword').value.trim();
            const app = document.getElementById('replitApp').value;

            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }

            try {
                const response = await fetch('/api/config/replit/connect', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        username, 
                        password,
                        app: app || null
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    alert('Successfully connected to Replit!');
                    if (data.apps && data.apps.length > 0) {
                        const appSelect = document.getElementById('replitApp');
                        appSelect.innerHTML = '<option value="">Select app to work on</option>';
                        data.apps.forEach(appName => {
                            const option = document.createElement('option');
                            option.value = appName;
                            option.textContent = appName;
                            appSelect.appendChild(option);
                        });
                    }
                } else {
                    alert(`Connection failed: ${data.error || 'Unknown error'}`);
                }
            } catch (error) {
                alert(`Error connecting to Replit: ${error.message}`);
            }
        }

        function saveSettings() {
            const username = document.getElementById('replitUsername').value.trim();
            const app = document.getElementById('replitApp').value;
            
            if (username) {
                localStorage.setItem('replitUsername', username);
            }
            if (app) {
                localStorage.setItem('replitApp', app);
            }
            
            alert('Settings saved!');
            closeSettings();
        }

        // Load saved settings on page load
        function loadSavedSettings() {
            const savedUsername = localStorage.getItem('replitUsername');
            const savedApp = localStorage.getItem('replitApp');
            
            if (savedUsername) {
                document.getElementById('replitUsername').value = savedUsername;
            }
            if (savedApp) {
                document.getElementById('replitApp').value = savedApp;
            }
        }

        // Load file tree on page load
        window.addEventListener('load', () => {
            loadFileTree();
            loadSavedSettings();
        });
    </script>
</body>
</html>
